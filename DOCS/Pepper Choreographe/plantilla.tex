\documentclass[a4paper]{article}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
%\usepackage[spanish]{babel}
\usepackage[english]{babel}
\usepackage{a4wide}
\usepackage{amsmath}
\usepackage{amssymb,amsfonts,textcomp}
\usepackage{color}
\usepackage{array}
\usepackage{supertabular}
\usepackage{hhline}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{float}
\usepackage{csquotes}
\usepackage{eurosym}
\usepackage{listings}
\restylefloat{table}
%\hypersetup{pdftex, colorlinks=true, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue, pdftitle=, pdfauthor=, pdfsubject=, pdfkeywords=}
\usepackage[pdftex]{graphicx}
% footnotes configuration
\makeatletter
\renewcommand\thefootnote{\arabic{footnote}}
\makeatother
% Text styles
\newcommand\textstyleStrongEmphasis[1]{\textbf{#1}}
% Outline numbering
\setcounter{secnumdepth}{0}
\makeatletter
\newcommand\arraybslash{\let\\\@arraycr}
\makeatother
% List styles
\newcommand\liststyleWWNumxxix{%
\renewcommand\labelitemi{{}-}
\renewcommand\labelitemii{o}
\renewcommand\labelitemiii{[F0A7?]}
\renewcommand\labelitemiv{[F0B7?]}
}
\newcommand\liststyleLi{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}%
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLii{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLiii{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLiv{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLv{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLvi{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{${\circ}$}
\renewcommand\labelitemiii{${\blacksquare}$}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLvii{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{{\textbullet}}
\renewcommand\labelitemiii{{\textbullet}}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLviii{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{{\textbullet}}
\renewcommand\labelitemiii{{\textbullet}}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLix{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{{\textbullet}}
\renewcommand\labelitemiii{{\textbullet}}
\renewcommand\labelitemiv{{\textbullet}}
}
\newcommand\liststyleLx{%
\renewcommand\labelitemi{{\textbullet}}
\renewcommand\labelitemii{{\textbullet}}
\renewcommand\labelitemiii{{\textbullet}}
\renewcommand\labelitemiv{{\textbullet}}
}
% Page layout (geometry)
\setlength\voffset{-1in}
\setlength\hoffset{-1in}
\setlength\topmargin{2cm}
\setlength\oddsidemargin{2cm}
\setlength\textheight{24.203001cm}
\setlength\textwidth{17.001cm}
\setlength\footskip{0.0cm}
\setlength\headheight{0.998cm}
\setlength\headsep{0.499cm}
% Footnote rule
\setlength{\skip\footins}{0.119cm}
\renewcommand\footnoterule{\vspace*{-0.018cm}\setlength\leftskip{0pt}\setlength\rightskip{0pt plus 1fil}\noindent\textcolor{black}{\rule{0.25\columnwidth}{0.018cm}}\vspace*{0.101cm}}
% Pages styles
\makeatletter
\newcommand\ps@Standard{
  \renewcommand\@oddhead{[Warning: Draw object ignored]}
  \renewcommand\@evenhead{\@oddhead}
  \renewcommand\@oddfoot{}
  \renewcommand\@evenfoot{}
  \renewcommand\thepage{\arabic{page}}
}
\newcommand\ps@FirstPage{
  \renewcommand\@oddhead{}
  \renewcommand\@evenhead{}
  \renewcommand\@oddfoot{}
  \renewcommand\@evenfoot{}
  \renewcommand\thepage{\arabic{page}}
}
\makeatother

\setlength\tabcolsep{1mm}
\renewcommand\arraystretch{1.3}
\title{}
\author{}
\date{2013-06-03}

\renewcommand{\baselinestretch}{1.2}

\begin{document}

\pagestyle{empty}
\setcounter{page}{0}

\includegraphics[width=3cm]{logo-uclm.jpg}
\hfill
\includegraphics[width=3cm]{logo-esii.png}

{\centering \par}
\begin{center}
\includegraphics[width=2.96cm,height=3.522cm]{logo-conciti.png}
\end{center}

\bigskip
{\centering\bfseries\large
UNIVERSIDAD DE CASTILLA-LA MANCHA
\par}

\bigskip
{\centering\bfseries\large
ESCUELA SUPERIOR DE INGENIERÍA INFORMÁTICA
\par}

\bigskip
{\centering\bfseries\large
GRADO EN INGENIERÍA INFORMÁTICA
\par}

\bigskip
{\centering\bfseries\large
DEPARTAMENTO DE SISTEMAS INFORMÁTICOS
\par}

\vskip 3em
{\centering\bfseries
HUMAN-ROBOT INTERACTION (HRI) WITH ROBOT PEPPER
\par}

\vfill % Rellena espacio automáticamente hasta ajustar al margen inferior 

\noindent Authors: 
\newline Hernan Indíbil de la Cruz Calvo.
\newline Alejandro Zornoza Martínez.

\vskip 1em 
\mbox{\begin{minipage}[b][2.5cm][c]{0.2\linewidth} {\large April, 2018}  \end{minipage}}
\hfill % Rellena espacio automáticamente hasta que la image se ajuste a la derecha
%\mbox{\includegraphics[width=10.5cm]{patrocinadores.png}}
%\vskip 1em %Un línea en blanco para que el logo de Euroinf no se pegue al footnote

\newpage
\thispagestyle{empty}
\mbox{}
\clearpage

\pagestyle{plain}
%\thispagestyle{FirstPage}

\setcounter{tocdepth}{10}
\pagenumbering{roman}
\setcounter{page}{1}
\renewcommand\contentsname{\'Indice de contenido}
\tableofcontents

\newpage
\thispagestyle{empty}
\mbox{}
\clearpage

\setcounter{page}{1}
\pagestyle{plain}
\pagenumbering{arabic}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% CONTENIDO %%%%%%%%%%%%%%%%%%%%%
\section{1.\ INTRODUCTION}

%El cap\'itulo de introducci\'on podr\'a abordar los siguientes aspectos:

%\liststyleWWNumxxix
%\begin{itemize}
%\item Introducci\'on al tema, entorno en el que el trabajo desempe\~nar\'a su objetivo, \ justificaci\'on de la
%importancia del trabajo abordado.
%\item Motivaci\'on y antecedentes (con algunas referencias bibliogr\'aficas).
%\item Descripci\'on gr\'afica del proyecto (es aconsejable incorporar una figura que describa el trabajo a desarrollar y
%que mejore la comprensi\'on del mismo).
%\end{itemize}

Nowadays with the evolution of technology and advances in recognition and speech algorithms, the capacibility of the robots increment so fast, that it is the reason why a lot of companies are working on robot development, robots will provide humans a lot of tools that they could make their life more easier.\newline

With the advance accomplished in the HRI(human robot interaction), we can provide to the robots habilities that help them to interact with humans and exchange information between them. \newline

The HRI(human robot interaction) is a multidisciplinary field with a lot of contributions from artificial intelligences, mecanics advances, robotics design, natural language understanding and social science. \newline

These set of science are working all time from improve the capabilities of the robots, making them strongers with better motors, making them more intelligent, making them more social and finally improving their natural language understanding and better in people recognition. \newline

We have learnt during practices how the robot acts depending diferent conditions and enviroments and now we are able to try to work with one of the most advanced robot in HRI that it is called Pepper. \newline

Pepper is a human-shaped robot, that it was design for being a genuine day-to-day companion, which it has the hability to perceive emotions and answer depending the type of them.\newline

The body of Pepper it is preparied for communicate with the people with the most natural and intuitive body language, giving it a friendly actitude and voice. \newline

With the memory capability the user can personalise the robot downloading the software applications and adapts himself to user tastes and habits. We  have to remember that his habilities are provided by researchers groups from around the world and the joing of all of them permits it design. \newline

In this project we are going to try to development our personal behaviours for Pepper and learning who a robot with these caracteristics acts, especially in face recognition, speak dialogs, hear words and move around following special orders defined by us. \newline

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{Meet-Pepper-SM.png}
	\label{Pepperintroduction}
\end{figure}


\newpage
\section{2.\ OBJECTIVES}
This project is focused on human-robot interaction using Robot Pepper. \newline
We have to do a study of the proposal, Choregraphe, as well as developing four different behaviours:
\begin{itemize}

 \item Speech-based commands to activate animations. \newline 
 There are some predefined animations we will have to associate with commands. \newline
 We will work with speech recognition in Choregraphe.
 
 \item "Come here" and "Follow me" behaviours. \newline
	The first one has to make the robot go to your position. \newline
	The last one has to make the robot follow you until you ask Pepper to stop. \newline
	To create both will require us to make use of the different tracking systems implemented in Choregraphe.
	
 \item A face learning and recognition behaviour. \newline
	We will study how to use face learning and recognition in Choregraphe.
 \item  A speech-based dialogue. \newline 
	We will have to make use of the "Dialog" boxes, as well as to learn the syntax used when writing a dialogue in Choregraphe.
\end{itemize}

\section{3.\ PRELIMINARIES}
\subsection{3.1.\ CHOREOGRAPHE}
We have to provide to the reader the enough knowledge about the development environment called choregraphe. We use it in this project to perform the human-robot interaction with Robot Pepper. One of the benefits of using this enviroment it is that the user do not need a lot of knowledge about programming in code. The reason is simple, it provides a toolbox diagram enviroment where the user can move and connect boxes that are defined to simulate the robot behavior. \newline

We will provide to the reader a tiny guide of using this enviroment and how we use to design the robot behaviors. \newline

First of all, we have to show the first interface page of choregraphe, but we have to remember first that the choregraphe installation package include other importants tools that we have to tell to the reader. \newline

The installation package includes:

\begin{itemize}
	\item Choregraphe 2.5.5 development tool: That it is the enviroment for design. We will explain more about it in other sections after that.
	\item NAO Documentation 2.5.5 : All relevant information about robots, enviroment, how to install, and uses are included there. It is importante documentation that the user can use to perform his hability while he is working with the robots, it includes documentation about Pepper, Nao and Romeo.
	\item Memory Backup 2.5.5: It provides the posibility of safe the robot state when we are working on it, it can save previusly installations and we can recover them if the user think it it necesary. This tool have two principal uses, the first one, save data installed on the robot and the second one restore data from the user computer to robot memory.
	\item Monitor 2.5.5: It provides the tools for monitoring and take information about memory and cameras data, we did not use it for this project.
\end{itemize}

Well, to start with we are going to explain all the information about the Choregraphe 2.5.5 development tool, and we will teach all the steps that we follow for make the project tasks. \newline

First of all, we open the Choregraphe 2.5.5 development tool and we can see the interface that we provide in the image  \ref{Choregrapheinterface} .
\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.3]{1choregraphe.png}
	\caption{Image of the Choregraphe main menu interface.}
	\label{Choregrapheinterface}
\end{figure}

At the Getting started window we can see diferent options:

\begin{itemize}
	\item Create a robot application: \begin{itemize} \item New project. \item Import project from CRG file. \item Import project from former project directory. \item Open project. \end{itemize}
	\item Documentation: \begin{itemize} \item Choregraphe guide. \item Coding in Python. \item Scripting in Choregraphe. \item Writing dialogs in Choregraphe. \end{itemize}
\end{itemize}

In addition the interface contains a top bar, one left bar and one right bar. \newline

\newpage
The top bar \ref{Topbar} contains the options for:

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.3]{2topbar.png}
	\caption{Image of the top bar.}
	\label{Topbar}
\end{figure}


\begin{itemize}
	\item The top part contains: 
	\begin{itemize}
		\item File options.
		\item Edit options.
		\item Connection options.
		\item View options.
		\item Help options.
	\end{itemize}	
	The bottom part of this bar provides:
	
	\begin{itemize}
		
		\item The first rectangle \ref{Topbar1} contains: Create project option, open recent project option, save project.
		\begin{figure}[ht]
			\centering
			\includegraphics[scale=0.5]{2topbar1.png}
			\caption{Image of the top bar first rectangle.}
			\label{Topbar1}		
		\end{figure}
		
		\item The second rectangle \ref{Topbar2} provides the option of backward or forward in the steps that we do.
		\begin{figure}[ht]
			\centering
			\includegraphics[scale=0.5]{2topbar2.png}
			\caption{Image of the top bar second rectangle.}
			\label{Topbar2}			
		\end{figure}
		
		\item The third rectangle \ref{Topbar3} provides the posibility of connect and disconnect to a robot or a simulate robot.
		\begin{figure}[!ht]
			\centering
			\includegraphics[scale=0.5]{2topbar3.png}
			\caption{Image of the top bar third rectangle.}
			\label{Topbar3}		
		\end{figure}
		\item The fourth rectangle \ref{Topbar4} provides options for upload to the robot and play, stop, debugs and errors output, the state {running, not running}, volume options and animation mode.
		\begin{figure}[!ht]
			\centering
			\includegraphics[scale=0.5]{2topbar4.png}
			\caption{Image of the top bar fourth rectangle.}
			\label{Topbar4}		
		\end{figure}

		\item The last rectangles \ref{Topbar5} provides options for turn autonomous life on/off, rest the robot, wake up the robot and battery information about the robot.		
		\begin{figure}[!ht]
			\centering
			\includegraphics[scale=0.4]{2topbar5.png}
			\caption{Image of the top bar fiveth rectangle.}
			\label{Topbar5}		
		\end{figure}		
	\end{itemize}	
\end{itemize}

\newpage
Also, we are going to continue giving information about other parts of the main menu interface, at the left side we can see this menu blocks \ref{leftbar1} .

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.9]{1leftbar.png}
	\caption{Image of the left bar.}
	\label{leftbar1}
\end{figure}
		
		
In this part the reader can see two different zones: the first one, at the top it provides information about project files, in the plus mark, you can create new behaviors, dialogs, planar moves, directories, or import files from other selected directories. \newline

The last one provides the user box libraries which will help the user to program the robot behaviors. It have 7 categories called:

\begin{itemize}
	\item Animation.
	\item Speech.
	\item LEDs.
	\item Multimedia.
	\item Movement.
	\item Sensing.
	\item Programming.
\end{itemize} 

We will explain better in future sections giving relevant information about the utility of these categories and the different types of boxes that they provide.\newline

On the other side, the right bar \ref{rightbar1} , it provides a video image of the robot where the user can see what is doing the robot doing, objects that are in front of him, and the currently distance of them. It is a place where you can test the robot behavior and the user can validate and test the designed behaviors. \newpage

%% right bar
\begin{figure}[!t]
	\centering
	\includegraphics[scale=1.5]{1rightbar.png}
	\caption{Image of the right bar with robot simulation.}
	\label{rightbar1}
\end{figure}

At the bottom, the user can see packages that are installed into the robot and options for install new ones or delete one of them.\newline

Finally,in the middle \ref{middledesignpart} , we have the space for the block designing.

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=1.5]{1middle.png}
	\caption{Image of the block diagram design section.}
	\label{middledesignpart}
\end{figure}

At the top the reader can see timelines blocks, it contains block that will show other block designing space. In the middle the user can drop blocks for making his behaviours, he have to connect the first one to the left arrow and the last one in the other side, at the right arrow.\newline

At the bottom the reader can see the log viewer for see error details, he can use the dialog text for writting messages to the robot, it provides to the user that he do not need to talk if he want to test for example a speech recognition block.

\subsection{3.2.\ HOW TO CONNECT TO PEPPER}
In order to start working Choregraphe we need to connect with Pepper.
First we need to be connected to the same network as the robot, in our case the network is called ``legoland''.
Once we are connected to the network, we can connect Choregraphe with Pepper. That can be done either by pressing Connection -> Connect to..., by pressing the green button in \ref{Topbar3} depicting an antenna with waves or by pressing Ctrl + Shift + C. \newline

Now we need to know the IP address that Pepper is using. We can know that by touching the button behind the tablet the robot is holding. We just need to write the IP address and the port the robot says in the Choregraphe screen shown in \ref{Connect1} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{connectto.png}
	\caption{Connect to... screen in Choregraphe.}
	\label{Connect1}		
\end{figure}
After that we only need to press the ``Select'' button and we will be connected to the robot. \newline 

To disconnect we can use either $Connection \rightarrow Disconnect$, the red button in \ref{Topbar3} or Ctrl + Shift + D.


\section{4.\ SPEECH RECOGNITION}
One of the most interesting things in Choregraphe is the ``Speech Recognition'' block in \ref{Speech1} .
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.6]{speechreco1.png}
	\caption{Speech Recognition block.}
	\label{Speech1}
\end{figure}

They allow us to interact with the robot with our voice. \newline

Inputs:
\begin{itemize}
	\item onStart: type ``Bang'', which means it will not treat the information received, it is just a signal that starts the box behaviour. It is the one marked with the play symbol.
	\item onStop: type ``Bang''. Stops the box behaviour. Marked with a red cross.
\end{itemize}

Outputs:
\begin{itemize}
	\item onStopped: type ``Bang''. Sends a signal after the box behaviour has stopped. Marked with a vertical red line with a black play symbol on its right side.
	\item wordRecognized: type ``String''. Sends the word the robot has recognized.
	\item onNothing: type ``Bang''. Sends a signal if Pepper has not heard anything during a certain timelapse.
\end{itemize}

The most important parameters are:
\begin{itemize}
	\item Word list: list of strings separated by semicolons the robot will try to recognize when that box behaviour is on.
	\item Confidence threshold: when the robot hears something, it assigns a confidence value to the word it has recognized. If that value does not reach the value set in this parameter, the word will not be recognized.
\end{itemize}

\subsection{4.1.\ ANIMATIONS}
There are a few animations already defined, as you can see in \ref{Animations1} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{animations1.png}
	\caption{Some predefined animation blocks.}
	\label{Animations1}
\end{figure}

In our example, we decided to use ``Gorilla'' and ``Football'' animations. \newline

Inputs:
\begin{itemize}
	\item onStart: type ``Bang''. Starts the box behaviour.
	\item onStop: type ``Bang''. Stops the box behaviour.
\end{itemize}

Outputs: \newpage
\begin{itemize}
	\item onStopped: type ``Bang''. Sends a signal after the box behaviour has stopped.
\end{itemize}

We have created a behaviour called ``SpeechCommands'' that has to perform an animation when it is said so, which diagram is the one being shown in \ref{SpeechCommands1} .

\begin{figure}[!h]
	\centering
	\includegraphics[scale=0.5]{speechcommands1.png}
	\caption{SpeechCommands behaviour diagram.}
	\label{SpeechCommands1}
\end{figure}

Firts we need to ``Wake Up'' the robot, otherwise it will not be able to perform anything. \newline

We created a block composed by more blocks in order to do that, called ``Awaken'' block. \newline 

Inputs:
\begin{itemize}
	\item onStart: type ``Bang''.
\end{itemize}

Outputs:
\begin{itemize}
	\item onSuccess: type ``Bang''. Sends a signal if the robot woke up correctly.
	\item onFailure: type ``Bang''. Sends a signal if the robot failed to wake up.
\end{itemize}

As we can see in \ref{Awaken1}, the block is composed by a ``Stand up'' box, some ``Set Language'' boxes and a ``Say'' box.

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{awaken1.png}
	\caption{Awaken box diagram.}
	\label{Awaken1}		
\end{figure}
\newpage

The ``Stand up'' box wakes up the robot, starts the motors and puts Pepper to its default position. \newline

If the robot woke up correctly then it will say a message. Else it will send a signal through its onFailure output. \newline

After that, we have the ``FaceAndSpeech'' block, which diagram is shown in \ref{FaceSpeech1} .
Inputs:
\begin{itemize}
	\item onStart: type ``Bang''.
	\item onStop: type ``Bang''.
\end{itemize}

Outputs:
\begin{itemize}
	\item onStopped: type ``Bang''.
	\item An type ``Bang'' output for each function the robot has to be able to perform. That is to say, if we want it to say ``Goodbye'' after the user says ``Bye'', ``See you'' or any other farewell, there will only be an output for all the farewells the robot can hear.
	\item End: type ``Bang''. When the robot is told to stop, this output will send a signal.
\end{itemize}

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{faceandspeech1.png}
	\caption{FaceAndSpeech box diagram.}
	\label{FaceSpeech1}
\end{figure}
This block has a Face Tracking box, a Speech Recognition box and a Switch box. The Speech Recognition box sends any word it recognizes to the Switch box that sends a signal to the correct output and stops both the tracking and the speech recognition. \newline

Since we wanted to make the robot more realistic, we added a Face Tracking box to make it follow the face of the person talking to it. \newline

The Speech Recognition box has in its wordlist the words ``Football'' and ``Gorilla''. The Switch box has only three cases, one for each word in the wordlist and another one for the ``end'' word. If someone writes ``end'' in Pepper's console, this case will be triggered. \newline

After the FaceAndSpeech box we have the animations and the message the robot says when it is told to stop.

\subsection{4.2.\ MOVEMENT}

We created the ``FollowCome'' behaviour, that implements both the ``Follow me'' and ``Come here'' voice commands. The diagram, that is very similar to that in \ref{SpeechCommands1} , can be seen in \ref{FollowCome1} .
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{followcome1.png}
	\caption{FollowCome behaviour diagram.}
	\label{FollowCome1}
\end{figure}

The only changes are inside FaceAndSpeech block and the animations have been replaced by new boxes. \newline

FaceAndSpeech box had its wordlist and cases changed to use the new voice commands: ``Follow me'' and ``Come here''. \newline
Instead of animations, we now have two new blocks: ``FollowActions'' and ``Come Here Actions''. \newline

They both have the same inputs and outputs, none other than onStart, onStop and onStopped. \newline

The FollowActions box, which diagram is shown in \ref{FollowActions1}, starts with the robot saying what the user has to do in order to stop the robot.

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{followme1.png}
	\caption{FollowActions box diagram.}
	\label{FollowActions1}
\end{figure}

\newpage
Then, it starts simmultaneously a Face Tracker box and a Speech Recognition box with two words in its wordlist: ``stop'' and ``blergh''.
Only having one word in its wordlist will make the robot try to hear only that word, making a lot of false positives. \newline 

After that box, a Switch box will stop everything when the robot hears ``stop'', and will do nothing otherwise. \newline

The Face Tracker box will make the robot move to the position of the face it is tracking. \newline 

When the robot is stopped, it says a phrase to let the user have some feedback. \newline

The ``Come Here Actions'' box is more simple, as can be seen in \ref{ComeActions1} . \newline

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.5]{comehere1.png}
	\caption{Come Here Actions box diagram.}
	\label{ComeActions1}
\end{figure}

It starts and end with say blocks, to let the user have some feedback. \newline

In the middle of those blocks, there is a face tracking box that moves the robot to the position of the user and stops when it reaches its target.\newline 

One important thing to take in account when using Choregraphe is that all the tracking and speech recognition blocks of the same type in the same diagram will be activated simmultaneously. \newline

That is to say: if you put two different Speech Recognition boxes in the same diagram, when you start one of them the other will start too, and if you stop one of them the other will also be stopped.\newline

The same happens to Face Tracking blocks. That's why we created complex boxes with smaller behaviours that only need one tracking box of each type as much. It helps us organize our work as well as fixing that problem.

\section{5.\ FACE RECOGNITION}
Pepper has a Face Learning module, that lets her to learn a face and to recognize it later. Subsequent learnings of the same face allows Pepper to speed up the recognizing proccess. \newline

We have created the behaviour ``Faces'', shown in \ref{Faces1}, that lets Pepper greet someone unknown to her and ask his/her name, in order to store the face. When Pepper meets someone whose face is already stored, she will greet that person by his/her name. 

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.5]{faces1.png}
	\caption{Faces behaviour diagram.}
	\label{Faces1}
\end{figure}

Again, the diagram is very similar to those of the previous behaviours.\newline

We had to change the wordlist and cases in FaceAndSpeech box, as well as the blocks that execute after it outputs something. \newline

We have two new blocks, both with onStart and onStop inputs and the onStopped output that restarts the FaceAndSpeech box like in the previous behaviours.\newline

When the user greets the robot, the ``Face Learner'' box is executed, that has the diagram shown in \ref{FaceLearner1} . 

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.5]{facelearner1.png}
	\caption{Face Learner box diagram.}
	\label{FaceLearner1}
\end{figure}

\newpage
It starts trying to recognize the user's face with the ``Face Recognition'' box. If it succeded in its task, the robot will greet the user and will say the user's name.\newline

Otherwise, the robot will ask for the user's name and will start a Speech Recognition box. The wordlist of this box has a list of possible user names. After hearing a name, the robot will learn the user's face with the heard name. \newline

If it succeded in its task, the robot will say ``Nice to meet you''. Otherwise, the robot will answer with a quote of a poem written by William Blake.\newline 

The other box, which diagram is the one appearing in \ref{FaceForget1}, is called ``Face Forget'' and lets us make the robot forget a certain face.
\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.5]{faceforget1.png}
	\caption{Face Forget box diagram.}
	\label{FaceForget1}
\end{figure}

The robot will ask for the name of the face the user wants it to forget. Again, a Speech Recognition box with a list of names as its wordlist will be activated. The robot will forget the face whose name the user has said using the ``Unlearn Face'' block. \newline

Finally, the robot will tell the user whether it was able to forget the face or not.

\section{6.\ DIALOGUE}

The last behaviour is a dialogue in which the robot interacts with a user talking and with animations. Its diagram is the one that appears in \ref{Dialogue1} .

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.5]{dialogue1.png}
	\caption{Dialogue behaviour diagram.}
	\label{Dialogue1}
\end{figure}

The Awaken box is different from its counterpart in the other behaviours, as can be seen in \ref{Awaken2} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{awaken2.png}
	\caption{Awaken box diagram in Dialogue behaviour.}
	\label{Awaken2}
\end{figure}

An image depicting the Sun will appear in the screen after the robot wakes up and says its wake up message. \newpage

The image is the one shown in \ref{IlSole} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.2]{SunImage.png}
	\caption{Sun image shown by the robot.}
	\label{IlSole}
\end{figure}

In order to reduce the amount of time it takes to load the image, its preloaded after the robot wakes up and displayed after the message is said. \newline

After the Awaken box, a new box is executed: the ``Face Learner'' box. It's very similar to the one in \ref{FaceLearner1}, but in this case we take advantage of the fact that you can relearn a face multiple times to speed up the recognition phase.\newline

As can be seen in \ref{FaceLearner2}, the main difference between this FaceLearner box and the other is that each time Pepper recognizes a face, it will relearn it.

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{facelearner2.png}
	\caption{FaceLearner box diagram in Dialogue behaviour.}
	\label{FaceLearner2}
\end{figure}

Using the face learning we let the robot to start a conversation by greeting someone known to Pepper or by asking someone's name. \newline

The other difference between this box and the previous one is that this one has a different output if Pepper detected a new face or not. \newline

If the face is new, the ``Greet Known'' box will be executed. Otherwise the ``Greet unknown'' box will be executed. \newline


The diagram of Greet unknown box is the one appearing in \ref{GreetUnknown1} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{greetunknown1.png}
	\caption{Greet unknown box diagram.}
	\label{GreetUnknown1}
\end{figure}

First the robot will ask the user whether he/she has ever thought about praising the Sun. \newline

If the answer is ``No'', the robot will ask the player to talk about the Sun and the Dialog box will start.\newline

If the answer is ``Yes'', the Greet Known box will be executed.
The diagram of Greet Known box is the one appearing in \ref{GreetKnown1}.

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{greetknown1.png}
	\caption{Greet Known box diagram.}
	\label{GreetKnown1}
\end{figure}

The robot will follow the user with its head with a Face Tracker box and will ask the player to praise the Sun together. \newline

After that the ``PraiseTheSun'' box will be executed. \newline

That box follows the diagram shown in \ref{PraiseTheSun1}.
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{praisethesun1.png}
	\caption{PraiseTheSun box diagram.}
	\label{PraiseTheSun1}
\end{figure}

First the robot will say ``Praise the Sun'', and then an animation of the robot praising the sun will start, leaving the robot in the same position as in the figure \ref{Praise1} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{praise1.png}
	\caption{Praise the Sun animation.}
	\label{Praise1}
\end{figure}
When the PraiseTheSun box ends, the Greet Known will end too. \newline

After that, the same boxes that will be executed if you answer ``No'' in the Greet unknown box will be executed, leading also to the Dialog box.\newline 

The Dialog box has a complex behaviour as can be seen in the figure \ref{DialogBox1} .
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{dialogbox1.png}
	\caption{Dialog box diagram.}
	\label{DialogBox1}
\end{figure}
\newpage
First the ``FaceAndDialog'' box is executed. Its diagram is \ref{FaceAndDialog1} .

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{faceanddialog.png}
	\caption{FaceAndDialog box diagram.}
	\label{FaceAndDialog1}
\end{figure}

It executes the next dialog:

\begin{lstlisting}
../src/Dialogue_Sun/Dialogue_Sun_enu.top
\end{lstlisting}
In this dialog, the robot can talk about what is the Sun, how to praise it, why to praise it, where to praise it, who is Gwyn, Gwynevere and Gwyndolin, and finally you can ask Pepper what can she do/help and you can say goodbye to her.\newline

While talking, there is a Face Tracker block that follows the user's head, to add more realism. \newline

There are three special dialog options. \newline

The farewell option will send a signal through the onStopped output of the FaceAndDialog option. It will start a PraiseTheSun box and the Dialog box will be stopped. \newline

The ``how to praise'' option will send a signal through the ``Praise'' output, and will start a PraiseTheSun box. After its behaviour is completed, the FaceAndDialog will be restarted. \newline

The ``where to praise'' option will send a signal through the ``Where'' output, starting the ``ChangeImage'' box. After its behaviour is completed, the FaceAndDialog will be restarted. \newline

The ChangeImage box, with the diagram that appears in \ref{ChangeImage1}, changes the image displayed in the tablet to the map of the ESIIAB shown in \ref{ESIIABMap} while saying the best place to praise the Sun inside of the ESIIAB.

\begin{figure}[!h]
	\centering
	\includegraphics[scale=0.5]{changeimage1.png}
	\caption{ChangeImage box diagram.}
	\label{ChangeImage1}
\end{figure}
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.09]{plano2500.png}
	\caption{ESIIAB map shown by the robot.}
	\label{ESIIABMap}
\end{figure}

After the farewell option was used and the robot has said goodbye, the Dialog box ends and the FaceLearner box will be run again.

\newpage
\section{7.\ CONCLUSIONS}
In conclusion we have learnt how Robot pepper works, the designer of the robot provides a special enviroment to design behaviors  and a interface where you can see the robot robot responses or simulate one to validate de behaviors design. \newline

This type of enviroment permits the user the posibility of program behaviors without writting code, but sometimes it increase the difficult when you have to make complex behaviors. \newline

We have implemented behaviours based on human-robot interaction, so it is so important that the robot have to maintenance the interaction and the contact with the person who is talking to it. \newline

In order to it is necesary use an important block called Face tracker, this block provides the robot the hability of face recognition, and follow the person which it is in interaction with it. \newline

Finally we identify that there are differents level of quality between the models designed by us and the installed packages from the designer, the reason it is simple with the blocks diagram and design a bit part of quality it is lost, with the code you can get more precision and better results that is why you personalize the code for the activity preferences. The blocks defined in the interface could be used for all types of behaviors that why we lose some precision as we have said before. \newline

It was an interesting project where we have the opportunity to work with one of the most modern commercial robot and we have learnt how to use the environment to perform the human-computer interaction, we know if the designer increase sensors cameras precision it could work in a lot of different places based on Human-compute
for example reception, museums, schools and a lot of different places providing quality information.

\clearpage

\section[8. REFERENCES]{8. REFERENCES}

\begingroup
\renewcommand{\section}[2]{}%

\begin{thebibliography}{10}
\providecommand{\url}[1]{\texttt{#1}}
\providecommand{\urlprefix}{URL}

\bibitem{Arkin} Arkin, R. C. (1998). \textit{Behavior-Based Robotics (Intelligent Robotics and Autonomous Agents)}. MIT Press.

\bibitem{Bekey} Bekey, G. (2005). \textit{Autonomous Robots: From Biological Inspiration to Implementation and Control}. MIT Press.

\bibitem{Murphy} Murphy, R. R. (2000). \textit{Introduction to AI Robotics}. MIT Press.

\bibitem{PHIL} Robo-Phil. (2014). \textit{Robo-Phil YouTube Channel}. Retrieved April, 2018 from \url{https://www.youtube.com/user/robotphilip/videos}

\bibitem{SOFTBANK} Softbank Robotics. (2017). \textit{Softbank Robotics Documentation}. Retrieved April 10, 2018 from \url{http://doc.aldebaran.com/}

%\bibitem{AR} ArcGIS for Developers, developers.arcgis.com. Consultado el 14 de Abril del 2018. \url{https://developers.arcgis.com/}

%\bibitem{BOUS} Bouskela, Mauricio., et al (2016),\textit{La ruta hacia las Smart Cities: Migrando de una gestión tradicional a la ciudad inteligente}. Banco Interamericano de Desarrollo.

%\bibitem{DGT} Dirección General de Tráfico, www.dgt.es. Consultado el 13 de Abril de 2018. \url{http://revista.dgt.es/es/categorias/distracciones-moviles.shtml}

%\bibitem{IBM} IBM Cloudant, www.ibm.com. Consultado el 14 de Abril del 2018. \url{https://www.ibm.com/cloud/cloudant}

%\bibitem{IBMII} IBM Bluemix, www.ibm.com. Consultado el 14 de Abril del 2018. \url{https://www.ibm.com/cloud-computing/bluemix/es}

%\bibitem{IO} Ionic, www.ionicframework.com. Consultado el 11 de Abril del 2018. \url{https://ionicframework.com/docs/}

%\bibitem{JA} Marco de Desarrollo de la Junta de Andalucia, \textit{Conceptos sobre Escalabilidad}, Consultado el 10 de Abril de 2018. \url{http://www.juntadeandalucia.es/servicios/madeja/contenido/recurso/220}

%\bibitem{NODE} Node-RED, www.nodered.org. Consultado el 16 de Abril del 2018. \url{https://nodered.org/docs/platforms/bluemix}

%\bibitem{NOSQL} Pandorafms, \textit{Bases de Datos NoSQL}, pandorafms.org. Consultado el 12 de Abril de 2018. \url{https://blog.pandorafms.org/es/bases-de-datos-nosql/}

%\bibitem{UCLM} Universidad de Castilla-la Mancha. www.uclm.es. Consultado el 9 de Abril de 2018. \url{https://eventos.uclm.es/19833/detail/hack-for-albacity.html}

%\bibitem{URB} URBIOTICA (2008), www.urbiotica.com. Consultado el 18 de Abril del 2018. \url{http://www.urbiotica.com/producto/u-spot/}

%\bibitem{W3} W3Schools (1998), www.w3schools.com. Consultado el 15 de Abril del 2018. \url{https://www.w3schools.com/nodejs/default.asp}

\end{thebibliography}

\endgroup

\clearpage

\section{ANNEXES}
\bigskip
\subsection{ANNEX I \ CONTENT LINKS}

\bigskip 
\begin{itemize}
\item \textbf{Pepper Speech Commands:} \newline
\url{https://www.youtube.com/watch?v=JPsfOQUvkfc}

\item \textbf{Pepper Follow Me and Come Here:} \newline
\url{https://www.youtube.com/watch?v=6oiSZy8PI6E}

\item \textbf{Pepper People Recognition:} \newline
\url{https://www.youtube.com/watch?v=yw0ogmP6dO8}

\item \textbf{Pepper Dialog:} \newline
\url{https://www.youtube.com/watch?v=crDNVtnfmrY}

\item \textbf{Project Repository:} \newline
\url{https://github.com/zorniffler/Pepper-behaviors}

\end{itemize}
\bigskip

\bigskip
\bigskip

\end{document}
